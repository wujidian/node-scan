webpackJsonp([4],{"Z+W8":function(e,t){},bGV4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),s=a.n(i),r=a("mCTZ"),o={name:"userVerification",data:function(){return{form:{name:"",idCard:"",idImageBack:"",idImageFront:""},formRules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],idCard:[{required:!0,message:"身份证号不能为空",trigger:"blur"},{pattern:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X)$)/,message:"身份证号格式错误",trigger:"blur"}],idImageBack:[{required:!0,message:"请上传身份证背面",trigger:"blur"}],idImageFront:[{required:!0,message:"请上传身份证正面",trigger:"blur"}]},isResubmit:!1,verificationDisabled:!1}},methods:{handleImgChange:function(e,t,a){var i=this,s=0==e.raw.type.indexOf("image")&&/\.(?:jpg|png|bmp)$/.test(e.name),r=e.size/1024/1024<4;if(!s)return this.$message.error("上传图片只能是JPG、PNG、BMP格式!"),!1;var o=new FileReader;o.readAsDataURL(e.raw),o.onload=function(t){var s=t.target.result;if(r)i.form[a]=s;else{var o=3984588.8/e.size,n=document.createElement("img");n.src=s,n.onload=function(){var e=i.compress(n,o);i.form[a]=e}}}},compress:function(e,t){e.src.length;var a=e.width*t,i=e.height*t,s=document.createElement("canvas"),r=s.getContext("2d");return s.width=a,s.height=i,r.fillStyle="#fff",r.fillRect(0,0,s.width,s.height),r.drawImage(e,0,0,a,i),s.toDataURL("image/jpeg")},submitVerification:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;t.verificationDisabled=!0,t.$api.uerVerity(s()({sessionId:localStorage.getItem("passport")},t.form)).then(function(a){Object(r.c)(function(i){i&&(t.verificationDisabled=!1,a.data[0]?(t.isResubmit=!0,t.$refs[e].resetFields()):(t.$message.error("认证失败，请检查认证信息"),t.isResubmit=!1))})}).catch(function(e){t.verificationDisabled=!1,t.$message.error(e.message)})})}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"userIdentityVerification"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.formRules,size:"small","label-position":"top","hide-required-asterisk":""}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入姓名",maxlength:"20"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"身份证号",prop:"idCard"}},[a("el-input",{attrs:{placeholder:"请输入身份证号",maxlength:"30"},model:{value:e.form.idCard,callback:function(t){e.$set(e.form,"idCard",t)},expression:"form.idCard"}})],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"idImageFront"}},[a("el-upload",{staticClass:"idUploader",attrs:{action:" ","show-file-list":!1,"auto-upload":!1,accept:".jpg, .jpeg, .png, .JPG, .JPEG, .bmp, .BMP","on-change":function(t,a){e.handleImgChange(t,a,"idImageFront")}}},[e.form.idImageFront?e._e():a("div",{staticStyle:{}},[e._v("请上传身份证正面")]),e._v(" "),e.form.idImageFront?a("img",{staticClass:"avatar",attrs:{src:e.form.idImageFront}}):e._e()])],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{prop:"idImageBack"}},[a("el-upload",{staticClass:"idUploader",attrs:{action:" ","show-file-list":!1,"auto-upload":!1,accept:".jpg, .jpeg, .png, .JPG, .JPEG, .bmp, .BMP","on-change":function(t,a){e.handleImgChange(t,a,"idImageBack")}}},[a("div",[e.form.idImageBack?a("img",{staticClass:"avatar",attrs:{src:e.form.idImageBack}}):e._e(),e._v(" "),e.form.idImageBack?e._e():a("div",{staticClass:"center"},[e._v("请上传身份证反面")])])])],1)],1)],1),e._v(" "),a("el-form-item",{staticClass:"center"},[a("button",{directives:[{name:"show",rawName:"v-show",value:1!==e.$store.state.info.isRealNameAuth&&e.isResubmit||-1==e.$store.state.info.isRealNameAuth&&e.isResubmit||0==e.$store.state.info.isRealNameAuth,expression:"($store.state.info.isRealNameAuth !== 1 &&  isResubmit) || ($store.state.info.isRealNameAuth == -1 &&  isResubmit) || ($store.state.info.isRealNameAuth == 0)"}],staticClass:"roundBtn",attrs:{type:"button",disabled:e.verificationDisabled},on:{click:function(t){return e.submitVerification("form")}}},[e._v("提交审核")])])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:1==e.$store.state.info.isRealNameAuth,expression:"$store.state.info.isRealNameAuth == 1 "}],staticClass:"center"},[a("div",{staticClass:"authSucee"},[e._v("认证成功")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:-1==e.$store.state.info.isRealNameAuth&&!e.isResubmit,expression:"$store.state.info.isRealNameAuth == -1  && !isResubmit"}],staticClass:"center"},[a("button",{staticClass:"authError",attrs:{type:"button"},on:{click:function(t){e.isResubmit=!0}}},[e._v("认证失败，请重新提交")])])],1)},staticRenderFns:[]};var m=a("VU/8")(o,n,!1,function(e){a("Z+W8"),a("nyr8")},"data-v-74c1bf88",null);t.default=m.exports},nyr8:function(e,t){}});
//# sourceMappingURL=4.b62784ce89f2847bf5e1.js.map